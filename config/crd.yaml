apiVersion: apiextensions.k8s.io/v1
kind: CustomResourceDefinition
metadata:
  name: tracingpolicies.cilium.io
  uid: b21a1891-a352-4e83-ae7c-3f5f9f4c52fa
  resourceVersion: '9808'
  generation: 2
  creationTimestamp: '2024-02-05T13:31:50Z'
  labels:
    cilium.io.k8s.crd.schema.version: 1.0.1
    k8slens-edit-resource-version: v1
  managedFields:
    - manager: kube-apiserver
      operation: Update
      apiVersion: apiextensions.k8s.io/v1
      time: '2024-02-05T13:31:50Z'
      fieldsType: FieldsV1
      fieldsV1:
        f:status:
          f:acceptedNames:
            f:kind: {}
            f:listKind: {}
            f:plural: {}
            f:singular: {}
          f:conditions:
            k:{"type":"Established"}:
              .: {}
              f:lastTransitionTime: {}
              f:message: {}
              f:reason: {}
              f:status: {}
              f:type: {}
            k:{"type":"NamesAccepted"}:
              .: {}
              f:lastTransitionTime: {}
              f:message: {}
              f:reason: {}
              f:status: {}
              f:type: {}
      subresource: status
    - manager: tetragon-operator
      operation: Update
      apiVersion: apiextensions.k8s.io/v1
      time: '2024-02-05T13:31:50Z'
      fieldsType: FieldsV1
      fieldsV1:
        f:metadata:
          f:labels:
            .: {}
            f:cilium.io.k8s.crd.schema.version: {}
        f:spec:
          f:conversion:
            .: {}
            f:strategy: {}
          f:group: {}
          f:names:
            f:kind: {}
            f:listKind: {}
            f:plural: {}
            f:singular: {}
          f:scope: {}
    - manager: node-fetch
      operation: Update
      apiVersion: apiextensions.k8s.io/v1
      time: '2024-02-05T14:36:34Z'
      fieldsType: FieldsV1
      fieldsV1:
        f:metadata:
          f:labels:
            f:k8slens-edit-resource-version: {}
        f:spec:
          f:versions: {}
  selfLink: >-
    /apis/apiextensions.k8s.io/v1/customresourcedefinitions/tracingpolicies.cilium.io
status:
  conditions:
    - type: NamesAccepted
      status: 'True'
      lastTransitionTime: '2024-02-05T13:31:50Z'
      reason: NoConflicts
      message: no conflicts found
    - type: Established
      status: 'True'
      lastTransitionTime: '2024-02-05T13:31:50Z'
      reason: InitialNamesAccepted
      message: the initial names have been accepted
  acceptedNames:
    plural: tracingpolicies
    singular: tracingpolicy
    kind: TracingPolicy
    listKind: TracingPolicyList
  storedVersions:
    - v1alpha1
spec:
  group: cilium.io
  names:
    plural: tracingpolicies
    singular: tracingpolicy
    kind: TracingPolicy
    listKind: TracingPolicyList
  scope: Cluster
  versions:
    - name: v1alpha1
      served: true
      storage: true
      schema:
        openAPIV3Schema:
          type: object
          required:
            - metadata
            - spec
          properties:
            apiVersion:
              description: >-
                APIVersion defines the versioned schema of this representation
                of an object. Servers should convert recognized schemas to the
                latest internal value, and may reject unrecognized values. More
                info:
                https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#resources
              type: string
            kind:
              description: >-
                Kind is a string value representing the REST resource this
                object represents. Servers may infer this from the endpoint the
                client submits requests to. Cannot be updated. In CamelCase.
                More info:
                https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#types-kinds
              type: string
            metadata:
              type: object
            spec:
              description: Tracing policy specification.
              type: object
              properties:
                killers:
                  description: A killer spec.
                  type: array
                  items:
                    type: object
                    required:
                      - syscalls
                    properties:
                      syscalls:
                        description: syscalls where killer is executed in
                        type: array
                        items:
                          type: string
                kprobes:
                  description: A list of kprobe specs.
                  type: array
                  items:
                    type: object
                    required:
                      - call
                    properties:
                      args:
                        description: >-
                          A list of function arguments to include in the trace
                          output.
                        type: array
                        items:
                          type: object
                          required:
                            - index
                            - type
                          properties:
                            index:
                              description: Position of the argument.
                              type: integer
                              format: int32
                              minimum: 0
                            label:
                              description: Label to output in the JSON
                              type: string
                            maxData:
                              description: >-
                                Read maximum possible data (currently 327360).
                                This field is only used for char_buff data. When
                                this value is false (default), the bpf program
                                will fetch at most 4096 bytes. In later kernels
                                (>=5.4) tetragon supports fetching up to 327360
                                bytes if this flag is turned on
                              type: boolean
                              default: false
                            returnCopy:
                              description: >-
                                This field is used only for char_buf and
                                char_iovec types. It indicates that this
                                argument should be read later (when the
                                kretprobe for the symbol is triggered) because
                                it might not be populated when the kprobe is
                                triggered at the entrance of the function. For
                                example, a buffer supplied to read(2) won't have
                                content until kretprobe is triggered.
                              type: boolean
                              default: false
                            sizeArgIndex:
                              description: >-
                                Specifies the position of the corresponding size
                                argument for this argument. This field is used
                                only for char_buf and char_iovec types.
                              type: integer
                              format: int32
                              minimum: 0
                            type:
                              description: Argument type.
                              type: string
                              default: auto
                              enum:
                                - auto
                                - int
                                - uint32
                                - int32
                                - uint64
                                - int64
                                - char_buf
                                - char_iovec
                                - size_t
                                - skb
                                - sock
                                - string
                                - fd
                                - file
                                - filename
                                - path
                                - nop
                                - bpf_attr
                                - perf_event
                                - bpf_map
                                - user_namespace
                                - capability
                                - kiocb
                                - iov_iter
                                - cred
                                - load_info
                                - module
                      call:
                        description: Name of the function to apply the kprobe spec to.
                        type: string
                      return:
                        description: >-
                          Indicates whether to collect return value of the
                          traced function.
                        type: boolean
                        default: false
                      returnArg:
                        description: A return argument to include in the trace output.
                        type: object
                        required:
                          - index
                          - type
                        properties:
                          index:
                            description: Position of the argument.
                            type: integer
                            format: int32
                            minimum: 0
                          label:
                            description: Label to output in the JSON
                            type: string
                          maxData:
                            description: >-
                              Read maximum possible data (currently 327360).
                              This field is only used for char_buff data. When
                              this value is false (default), the bpf program
                              will fetch at most 4096 bytes. In later kernels
                              (>=5.4) tetragon supports fetching up to 327360
                              bytes if this flag is turned on
                            type: boolean
                            default: false
                          returnCopy:
                            description: >-
                              This field is used only for char_buf and
                              char_iovec types. It indicates that this argument
                              should be read later (when the kretprobe for the
                              symbol is triggered) because it might not be
                              populated when the kprobe is triggered at the
                              entrance of the function. For example, a buffer
                              supplied to read(2) won't have content until
                              kretprobe is triggered.
                            type: boolean
                            default: false
                          sizeArgIndex:
                            description: >-
                              Specifies the position of the corresponding size
                              argument for this argument. This field is used
                              only for char_buf and char_iovec types.
                            type: integer
                            format: int32
                            minimum: 0
                          type:
                            description: Argument type.
                            type: string
                            default: auto
                            enum:
                              - auto
                              - int
                              - uint32
                              - int32
                              - uint64
                              - int64
                              - char_buf
                              - char_iovec
                              - size_t
                              - skb
                              - sock
                              - string
                              - fd
                              - file
                              - filename
                              - path
                              - nop
                              - bpf_attr
                              - perf_event
                              - bpf_map
                              - user_namespace
                              - capability
                              - kiocb
                              - iov_iter
                              - cred
                              - load_info
                              - module
                      returnArgAction:
                        description: >-
                          An action to perform on the return argument. Available
                          actions are: Post;TrackSock;UntrackSock
                        type: string
                      selectors:
                        description: >-
                          Selectors to apply before producing trace output.
                          Selectors are ORed.
                        type: array
                        items:
                          description: >-
                            KProbeSelector selects function calls for kprobe
                            based on PIDs and function arguments. The results of
                            MatchPIDs and MatchArgs are ANDed.
                          type: object
                          properties:
                            matchActions:
                              description: >-
                                A list of actions to execute when this selector
                                matches
                              type: array
                              items:
                                type: object
                                required:
                                  - action
                                properties:
                                  action:
                                    description: Action to execute.
                                    type: string
                                    enum:
                                      - Post
                                      - FollowFD
                                      - UnfollowFD
                                      - Sigkill
                                      - CopyFD
                                      - Override
                                      - GetUrl
                                      - DnsLookup
                                      - NoPost
                                      - Signal
                                      - TrackSock
                                      - UntrackSock
                                      - NotifyKiller
                                  argError:
                                    description: error value for override action
                                    type: integer
                                    format: int32
                                  argFd:
                                    description: >-
                                      An arg index for the fd for fdInstall
                                      action
                                    type: integer
                                    format: int32
                                  argFqdn:
                                    description: A FQDN to lookup for the dnsLookup action
                                    type: string
                                  argName:
                                    description: >-
                                      An arg index for the filename for
                                      fdInstall action
                                    type: integer
                                    format: int32
                                  argSig:
                                    description: A signal number for signal action
                                    type: integer
                                    format: int32
                                  argSock:
                                    description: >-
                                      An arg index for the sock for trackSock
                                      and untrackSock actions
                                    type: integer
                                    format: int32
                                  argUrl:
                                    description: A URL for the getUrl action
                                    type: string
                                  rateLimit:
                                    description: >-
                                      A time period within which repeated
                                      messages will not be posted. Can be
                                      specified in seconds (default or with 's'
                                      suffix), minutes ('m' suffix) or hours
                                      ('h' suffix). Only valid with the post
                                      action.
                                    type: string
                                  stackTrace:
                                    description: >-
                                      Enable stack trace export. Only valid with
                                      the post action.
                                    type: boolean
                            matchArgs:
                              description: A list of argument filters. MatchArgs are ANDed.
                              type: array
                              items:
                                type: object
                                required:
                                  - index
                                  - operator
                                properties:
                                  index:
                                    description: >-
                                      Position of the argument to apply fhe
                                      filter to.
                                    type: integer
                                    format: int32
                                    minimum: 0
                                  operator:
                                    description: Filter operation.
                                    type: string
                                    enum:
                                      - Equal
                                      - NotEqual
                                      - Prefix
                                      - NotPrefix
                                      - Postfix
                                      - NotPostfix
                                      - GreaterThan
                                      - LessThan
                                      - GT
                                      - LT
                                      - Mask
                                      - SPort
                                      - NotSPort
                                      - SPortPriv
                                      - NotSportPriv
                                      - DPort
                                      - NotDPort
                                      - DPortPriv
                                      - NotDPortPriv
                                      - SAddr
                                      - NotSAddr
                                      - DAddr
                                      - NotDAddr
                                      - Protocol
                                      - Family
                                      - State
                                      - InMap
                                      - NotInMap
                                      - Priority
                                  values:
                                    description: Value to compare the argument against.
                                    type: array
                                    items:
                                      type: string
                            matchBinaries:
                              description: A list of binary exec name filters.
                              type: array
                              items:
                                type: object
                                required:
                                  - operator
                                  - values
                                properties:
                                  operator:
                                    description: Filter operation.
                                    type: string
                                    enum:
                                      - In
                                      - NotIn
                                  values:
                                    description: Value to compare the argument against.
                                    type: array
                                    items:
                                      type: string
                            matchCapabilities:
                              description: A list of capabilities and IDs
                              type: array
                              items:
                                type: object
                                required:
                                  - operator
                                  - values
                                properties:
                                  isNamespaceCapability:
                                    description: >-
                                      Indicates whether these caps are namespace
                                      caps.
                                    type: boolean
                                    default: false
                                  operator:
                                    description: Namespace selector operator.
                                    type: string
                                    enum:
                                      - In
                                      - NotIn
                                  type:
                                    description: Type of capabilities
                                    type: string
                                    default: Effective
                                    enum:
                                      - Effective
                                      - Inheritable
                                      - Permitted
                                  values:
                                    description: Capabilities to match.
                                    type: array
                                    items:
                                      type: string
                            matchCapabilityChanges:
                              description: IDs for capabilities changes
                              type: array
                              items:
                                type: object
                                required:
                                  - operator
                                  - values
                                properties:
                                  isNamespaceCapability:
                                    description: >-
                                      Indicates whether these caps are namespace
                                      caps.
                                    type: boolean
                                    default: false
                                  operator:
                                    description: Namespace selector operator.
                                    type: string
                                    enum:
                                      - In
                                      - NotIn
                                  type:
                                    description: Type of capabilities
                                    type: string
                                    default: Effective
                                    enum:
                                      - Effective
                                      - Inheritable
                                      - Permitted
                                  values:
                                    description: Capabilities to match.
                                    type: array
                                    items:
                                      type: string
                            matchNamespaceChanges:
                              description: IDs for namespace changes
                              type: array
                              items:
                                type: object
                                required:
                                  - operator
                                  - values
                                properties:
                                  operator:
                                    description: Namespace selector operator.
                                    type: string
                                    enum:
                                      - In
                                      - NotIn
                                  values:
                                    description: Namespace types (e.g., Mnt, Pid) to match.
                                    type: array
                                    items:
                                      type: string
                            matchNamespaces:
                              description: A list of namespaces and IDs
                              type: array
                              items:
                                type: object
                                required:
                                  - namespace
                                  - operator
                                  - values
                                properties:
                                  namespace:
                                    description: Namespace selector name.
                                    type: string
                                    enum:
                                      - Uts
                                      - Ipc
                                      - Mnt
                                      - Pid
                                      - PidForChildren
                                      - Net
                                      - Time
                                      - TimeForChildren
                                      - Cgroup
                                      - User
                                  operator:
                                    description: Namespace selector operator.
                                    type: string
                                    enum:
                                      - In
                                      - NotIn
                                  values:
                                    description: >-
                                      Namespace IDs (or host_ns for host
                                      namespace) of namespaces to match.
                                    type: array
                                    items:
                                      type: string
                            matchPIDs:
                              description: >-
                                A list of process ID filters. MatchPIDs are
                                ANDed.
                              type: array
                              items:
                                type: object
                                required:
                                  - operator
                                  - values
                                properties:
                                  followForks:
                                    description: >-
                                      Matches any descendant processes of the
                                      matching PIDs.
                                    type: boolean
                                    default: false
                                  isNamespacePID:
                                    description: Indicates whether PIDs are namespace PIDs.
                                    type: boolean
                                    default: false
                                  operator:
                                    description: PID selector operator.
                                    type: string
                                    enum:
                                      - In
                                      - NotIn
                                  values:
                                    description: Process IDs to match.
                                    type: array
                                    items:
                                      type: integer
                                      format: int32
                            matchReturnArgs:
                              description: A list of argument filters. MatchArgs are ANDed.
                              type: array
                              items:
                                type: object
                                required:
                                  - index
                                  - operator
                                properties:
                                  index:
                                    description: >-
                                      Position of the argument to apply fhe
                                      filter to.
                                    type: integer
                                    format: int32
                                    minimum: 0
                                  operator:
                                    description: Filter operation.
                                    type: string
                                    enum:
                                      - Equal
                                      - NotEqual
                                      - Prefix
                                      - NotPrefix
                                      - Postfix
                                      - NotPostfix
                                      - GreaterThan
                                      - LessThan
                                      - GT
                                      - LT
                                      - Mask
                                      - SPort
                                      - NotSPort
                                      - SPortPriv
                                      - NotSportPriv
                                      - DPort
                                      - NotDPort
                                      - DPortPriv
                                      - NotDPortPriv
                                      - SAddr
                                      - NotSAddr
                                      - DAddr
                                      - NotDAddr
                                      - Protocol
                                      - Family
                                      - State
                                      - InMap
                                      - NotInMap
                                      - Priority
                                  values:
                                    description: Value to compare the argument against.
                                    type: array
                                    items:
                                      type: string
                      syscall:
                        description: Indicates whether the traced function is a syscall.
                        type: boolean
                        default: true
                lists:
                  description: A list of list specs.
                  type: array
                  items:
                    type: object
                    required:
                      - name
                    properties:
                      name:
                        description: Name of the list
                        type: string
                      pattern:
                        description: Pattern for 'generated' lists.
                        type: string
                      type:
                        description: Indicates the type of the list values.
                        type: string
                        enum:
                          - syscalls
                          - generated_syscalls
                          - generated_ftrace
                      validated:
                        description: List was validated
                        type: boolean
                      values:
                        description: Values of the list
                        type: array
                        items:
                          type: string
                loader:
                  description: Enable loader events
                  type: boolean
                options:
                  description: A list of overloaded options
                  type: array
                  items:
                    type: object
                    required:
                      - name
                    properties:
                      name:
                        description: Name of the option
                        type: string
                      value:
                        description: Value of the option
                        type: string
                podSelector:
                  description: PodSelector selects pods that this policy applies to
                  type: object
                  properties:
                    matchExpressions:
                      description: >-
                        matchExpressions is a list of label selector
                        requirements. The requirements are ANDed.
                      type: array
                      items:
                        description: >-
                          A label selector requirement is a selector that
                          contains values, a key, and an operator that relates
                          the key and values.
                        type: object
                        required:
                          - key
                          - operator
                        properties:
                          key:
                            description: key is the label key that the selector applies to.
                            type: string
                          operator:
                            description: >-
                              operator represents a key's relationship to a set
                              of values. Valid operators are In, NotIn, Exists
                              and DoesNotExist.
                            type: string
                            enum:
                              - In
                              - NotIn
                              - Exists
                              - DoesNotExist
                          values:
                            description: >-
                              values is an array of string values. If the
                              operator is In or NotIn, the values array must be
                              non-empty. If the operator is Exists or
                              DoesNotExist, the values array must be empty. This
                              array is replaced during a strategic merge patch.
                            type: array
                            items:
                              type: string
                    matchLabels:
                      description: >-
                        matchLabels is a map of {key,value} pairs. A single
                        {key,value} in the matchLabels map is equivalent to an
                        element of matchExpressions, whose key field is "key",
                        the operator is "In", and the values array contains only
                        "value". The requirements are ANDed.
                      type: object
                      additionalProperties:
                        description: >-
                          MatchLabelsValue represents the value from the
                          MatchLabels {key,value} pair.
                        type: string
                        maxLength: 63
                        pattern: ^(([A-Za-z0-9][-A-Za-z0-9_.]*)?[A-Za-z0-9])?$
                tracepoints:
                  description: A list of tracepoint specs.
                  type: array
                  items:
                    type: object
                    required:
                      - event
                      - subsystem
                    properties:
                      args:
                        description: >-
                          A list of function arguments to include in the trace
                          output.
                        type: array
                        items:
                          type: object
                          required:
                            - index
                            - type
                          properties:
                            index:
                              description: Position of the argument.
                              type: integer
                              format: int32
                              minimum: 0
                            label:
                              description: Label to output in the JSON
                              type: string
                            maxData:
                              description: >-
                                Read maximum possible data (currently 327360).
                                This field is only used for char_buff data. When
                                this value is false (default), the bpf program
                                will fetch at most 4096 bytes. In later kernels
                                (>=5.4) tetragon supports fetching up to 327360
                                bytes if this flag is turned on
                              type: boolean
                              default: false
                            returnCopy:
                              description: >-
                                This field is used only for char_buf and
                                char_iovec types. It indicates that this
                                argument should be read later (when the
                                kretprobe for the symbol is triggered) because
                                it might not be populated when the kprobe is
                                triggered at the entrance of the function. For
                                example, a buffer supplied to read(2) won't have
                                content until kretprobe is triggered.
                              type: boolean
                              default: false
                            sizeArgIndex:
                              description: >-
                                Specifies the position of the corresponding size
                                argument for this argument. This field is used
                                only for char_buf and char_iovec types.
                              type: integer
                              format: int32
                              minimum: 0
                            type:
                              description: Argument type.
                              type: string
                              default: auto
                              enum:
                                - auto
                                - int
                                - uint32
                                - int32
                                - uint64
                                - int64
                                - char_buf
                                - char_iovec
                                - size_t
                                - skb
                                - sock
                                - string
                                - fd
                                - file
                                - filename
                                - path
                                - nop
                                - bpf_attr
                                - perf_event
                                - bpf_map
                                - user_namespace
                                - capability
                                - kiocb
                                - iov_iter
                                - cred
                                - load_info
                                - module
                      event:
                        description: Tracepoint event
                        type: string
                      selectors:
                        description: >-
                          Selectors to apply before producing trace output.
                          Selectors are ORed.
                        type: array
                        items:
                          description: >-
                            KProbeSelector selects function calls for kprobe
                            based on PIDs and function arguments. The results of
                            MatchPIDs and MatchArgs are ANDed.
                          type: object
                          properties:
                            matchActions:
                              description: >-
                                A list of actions to execute when this selector
                                matches
                              type: array
                              items:
                                type: object
                                required:
                                  - action
                                properties:
                                  action:
                                    description: Action to execute.
                                    type: string
                                    enum:
                                      - Post
                                      - FollowFD
                                      - UnfollowFD
                                      - Sigkill
                                      - CopyFD
                                      - Override
                                      - GetUrl
                                      - DnsLookup
                                      - NoPost
                                      - Signal
                                      - TrackSock
                                      - UntrackSock
                                      - NotifyKiller
                                  argError:
                                    description: error value for override action
                                    type: integer
                                    format: int32
                                  argFd:
                                    description: >-
                                      An arg index for the fd for fdInstall
                                      action
                                    type: integer
                                    format: int32
                                  argFqdn:
                                    description: A FQDN to lookup for the dnsLookup action
                                    type: string
                                  argName:
                                    description: >-
                                      An arg index for the filename for
                                      fdInstall action
                                    type: integer
                                    format: int32
                                  argSig:
                                    description: A signal number for signal action
                                    type: integer
                                    format: int32
                                  argSock:
                                    description: >-
                                      An arg index for the sock for trackSock
                                      and untrackSock actions
                                    type: integer
                                    format: int32
                                  argUrl:
                                    description: A URL for the getUrl action
                                    type: string
                                  rateLimit:
                                    description: >-
                                      A time period within which repeated
                                      messages will not be posted. Can be
                                      specified in seconds (default or with 's'
                                      suffix), minutes ('m' suffix) or hours
                                      ('h' suffix). Only valid with the post
                                      action.
                                    type: string
                                  stackTrace:
                                    description: >-
                                      Enable stack trace export. Only valid with
                                      the post action.
                                    type: boolean
                            matchArgs:
                              description: A list of argument filters. MatchArgs are ANDed.
                              type: array
                              items:
                                type: object
                                required:
                                  - index
                                  - operator
                                properties:
                                  index:
                                    description: >-
                                      Position of the argument to apply fhe
                                      filter to.
                                    type: integer
                                    format: int32
                                    minimum: 0
                                  operator:
                                    description: Filter operation.
                                    type: string
                                    enum:
                                      - Equal
                                      - NotEqual
                                      - Prefix
                                      - NotPrefix
                                      - Postfix
                                      - NotPostfix
                                      - GreaterThan
                                      - LessThan
                                      - GT
                                      - LT
                                      - Mask
                                      - SPort
                                      - NotSPort
                                      - SPortPriv
                                      - NotSportPriv
                                      - DPort
                                      - NotDPort
                                      - DPortPriv
                                      - NotDPortPriv
                                      - SAddr
                                      - NotSAddr
                                      - DAddr
                                      - NotDAddr
                                      - Protocol
                                      - Family
                                      - State
                                      - InMap
                                      - NotInMap
                                      - Priority
                                  values:
                                    description: Value to compare the argument against.
                                    type: array
                                    items:
                                      type: string
                            matchBinaries:
                              description: A list of binary exec name filters.
                              type: array
                              items:
                                type: object
                                required:
                                  - operator
                                  - values
                                properties:
                                  operator:
                                    description: Filter operation.
                                    type: string
                                    enum:
                                      - In
                                      - NotIn
                                  values:
                                    description: Value to compare the argument against.
                                    type: array
                                    items:
                                      type: string
                            matchCapabilities:
                              description: A list of capabilities and IDs
                              type: array
                              items:
                                type: object
                                required:
                                  - operator
                                  - values
                                properties:
                                  isNamespaceCapability:
                                    description: >-
                                      Indicates whether these caps are namespace
                                      caps.
                                    type: boolean
                                    default: false
                                  operator:
                                    description: Namespace selector operator.
                                    type: string
                                    enum:
                                      - In
                                      - NotIn
                                  type:
                                    description: Type of capabilities
                                    type: string
                                    default: Effective
                                    enum:
                                      - Effective
                                      - Inheritable
                                      - Permitted
                                  values:
                                    description: Capabilities to match.
                                    type: array
                                    items:
                                      type: string
                            matchCapabilityChanges:
                              description: IDs for capabilities changes
                              type: array
                              items:
                                type: object
                                required:
                                  - operator
                                  - values
                                properties:
                                  isNamespaceCapability:
                                    description: >-
                                      Indicates whether these caps are namespace
                                      caps.
                                    type: boolean
                                    default: false
                                  operator:
                                    description: Namespace selector operator.
                                    type: string
                                    enum:
                                      - In
                                      - NotIn
                                  type:
                                    description: Type of capabilities
                                    type: string
                                    default: Effective
                                    enum:
                                      - Effective
                                      - Inheritable
                                      - Permitted
                                  values:
                                    description: Capabilities to match.
                                    type: array
                                    items:
                                      type: string
                            matchNamespaceChanges:
                              description: IDs for namespace changes
                              type: array
                              items:
                                type: object
                                required:
                                  - operator
                                  - values
                                properties:
                                  operator:
                                    description: Namespace selector operator.
                                    type: string
                                    enum:
                                      - In
                                      - NotIn
                                  values:
                                    description: Namespace types (e.g., Mnt, Pid) to match.
                                    type: array
                                    items:
                                      type: string
                            matchNamespaces:
                              description: A list of namespaces and IDs
                              type: array
                              items:
                                type: object
                                required:
                                  - namespace
                                  - operator
                                  - values
                                properties:
                                  namespace:
                                    description: Namespace selector name.
                                    type: string
                                    enum:
                                      - Uts
                                      - Ipc
                                      - Mnt
                                      - Pid
                                      - PidForChildren
                                      - Net
                                      - Time
                                      - TimeForChildren
                                      - Cgroup
                                      - User
                                  operator:
                                    description: Namespace selector operator.
                                    type: string
                                    enum:
                                      - In
                                      - NotIn
                                  values:
                                    description: >-
                                      Namespace IDs (or host_ns for host
                                      namespace) of namespaces to match.
                                    type: array
                                    items:
                                      type: string
                            matchPIDs:
                              description: >-
                                A list of process ID filters. MatchPIDs are
                                ANDed.
                              type: array
                              items:
                                type: object
                                required:
                                  - operator
                                  - values
                                properties:
                                  followForks:
                                    description: >-
                                      Matches any descendant processes of the
                                      matching PIDs.
                                    type: boolean
                                    default: false
                                  isNamespacePID:
                                    description: Indicates whether PIDs are namespace PIDs.
                                    type: boolean
                                    default: false
                                  operator:
                                    description: PID selector operator.
                                    type: string
                                    enum:
                                      - In
                                      - NotIn
                                  values:
                                    description: Process IDs to match.
                                    type: array
                                    items:
                                      type: integer
                                      format: int32
                            matchReturnArgs:
                              description: A list of argument filters. MatchArgs are ANDed.
                              type: array
                              items:
                                type: object
                                required:
                                  - index
                                  - operator
                                properties:
                                  index:
                                    description: >-
                                      Position of the argument to apply fhe
                                      filter to.
                                    type: integer
                                    format: int32
                                    minimum: 0
                                  operator:
                                    description: Filter operation.
                                    type: string
                                    enum:
                                      - Equal
                                      - NotEqual
                                      - Prefix
                                      - NotPrefix
                                      - Postfix
                                      - NotPostfix
                                      - GreaterThan
                                      - LessThan
                                      - GT
                                      - LT
                                      - Mask
                                      - SPort
                                      - NotSPort
                                      - SPortPriv
                                      - NotSportPriv
                                      - DPort
                                      - NotDPort
                                      - DPortPriv
                                      - NotDPortPriv
                                      - SAddr
                                      - NotSAddr
                                      - DAddr
                                      - NotDAddr
                                      - Protocol
                                      - Family
                                      - State
                                      - InMap
                                      - NotInMap
                                      - Priority
                                  values:
                                    description: Value to compare the argument against.
                                    type: array
                                    items:
                                      type: string
                      subsystem:
                        description: Tracepoint subsystem
                        type: string
                uprobes:
                  description: A list of uprobe specs.
                  type: array
                  items:
                    type: object
                    required:
                      - path
                      - symbol
                    properties:
                      path:
                        description: Name of the traced binary
                        type: string
                      selectors:
                        description: >-
                          Selectors to apply before producing trace output.
                          Selectors are ORed.
                        type: array
                        items:
                          description: >-
                            KProbeSelector selects function calls for kprobe
                            based on PIDs and function arguments. The results of
                            MatchPIDs and MatchArgs are ANDed.
                          type: object
                          properties:
                            matchActions:
                              description: >-
                                A list of actions to execute when this selector
                                matches
                              type: array
                              items:
                                type: object
                                required:
                                  - action
                                properties:
                                  action:
                                    description: Action to execute.
                                    type: string
                                    enum:
                                      - Post
                                      - FollowFD
                                      - UnfollowFD
                                      - Sigkill
                                      - CopyFD
                                      - Override
                                      - GetUrl
                                      - DnsLookup
                                      - NoPost
                                      - Signal
                                      - TrackSock
                                      - UntrackSock
                                      - NotifyKiller
                                  argError:
                                    description: error value for override action
                                    type: integer
                                    format: int32
                                  argFd:
                                    description: >-
                                      An arg index for the fd for fdInstall
                                      action
                                    type: integer
                                    format: int32
                                  argFqdn:
                                    description: A FQDN to lookup for the dnsLookup action
                                    type: string
                                  argName:
                                    description: >-
                                      An arg index for the filename for
                                      fdInstall action
                                    type: integer
                                    format: int32
                                  argSig:
                                    description: A signal number for signal action
                                    type: integer
                                    format: int32
                                  argSock:
                                    description: >-
                                      An arg index for the sock for trackSock
                                      and untrackSock actions
                                    type: integer
                                    format: int32
                                  argUrl:
                                    description: A URL for the getUrl action
                                    type: string
                                  rateLimit:
                                    description: >-
                                      A time period within which repeated
                                      messages will not be posted. Can be
                                      specified in seconds (default or with 's'
                                      suffix), minutes ('m' suffix) or hours
                                      ('h' suffix). Only valid with the post
                                      action.
                                    type: string
                                  stackTrace:
                                    description: >-
                                      Enable stack trace export. Only valid with
                                      the post action.
                                    type: boolean
                            matchArgs:
                              description: A list of argument filters. MatchArgs are ANDed.
                              type: array
                              items:
                                type: object
                                required:
                                  - index
                                  - operator
                                properties:
                                  index:
                                    description: >-
                                      Position of the argument to apply fhe
                                      filter to.
                                    type: integer
                                    format: int32
                                    minimum: 0
                                  operator:
                                    description: Filter operation.
                                    type: string
                                    enum:
                                      - Equal
                                      - NotEqual
                                      - Prefix
                                      - NotPrefix
                                      - Postfix
                                      - NotPostfix
                                      - GreaterThan
                                      - LessThan
                                      - GT
                                      - LT
                                      - Mask
                                      - SPort
                                      - NotSPort
                                      - SPortPriv
                                      - NotSportPriv
                                      - DPort
                                      - NotDPort
                                      - DPortPriv
                                      - NotDPortPriv
                                      - SAddr
                                      - NotSAddr
                                      - DAddr
                                      - NotDAddr
                                      - Protocol
                                      - Family
                                      - State
                                      - InMap
                                      - NotInMap
                                      - Priority
                                  values:
                                    description: Value to compare the argument against.
                                    type: array
                                    items:
                                      type: string
                            matchBinaries:
                              description: A list of binary exec name filters.
                              type: array
                              items:
                                type: object
                                required:
                                  - operator
                                  - values
                                properties:
                                  operator:
                                    description: Filter operation.
                                    type: string
                                    enum:
                                      - In
                                      - NotIn
                                  values:
                                    description: Value to compare the argument against.
                                    type: array
                                    items:
                                      type: string
                            matchCapabilities:
                              description: A list of capabilities and IDs
                              type: array
                              items:
                                type: object
                                required:
                                  - operator
                                  - values
                                properties:
                                  isNamespaceCapability:
                                    description: >-
                                      Indicates whether these caps are namespace
                                      caps.
                                    type: boolean
                                    default: false
                                  operator:
                                    description: Namespace selector operator.
                                    type: string
                                    enum:
                                      - In
                                      - NotIn
                                  type:
                                    description: Type of capabilities
                                    type: string
                                    default: Effective
                                    enum:
                                      - Effective
                                      - Inheritable
                                      - Permitted
                                  values:
                                    description: Capabilities to match.
                                    type: array
                                    items:
                                      type: string
                            matchCapabilityChanges:
                              description: IDs for capabilities changes
                              type: array
                              items:
                                type: object
                                required:
                                  - operator
                                  - values
                                properties:
                                  isNamespaceCapability:
                                    description: >-
                                      Indicates whether these caps are namespace
                                      caps.
                                    type: boolean
                                    default: false
                                  operator:
                                    description: Namespace selector operator.
                                    type: string
                                    enum:
                                      - In
                                      - NotIn
                                  type:
                                    description: Type of capabilities
                                    type: string
                                    default: Effective
                                    enum:
                                      - Effective
                                      - Inheritable
                                      - Permitted
                                  values:
                                    description: Capabilities to match.
                                    type: array
                                    items:
                                      type: string
                            matchNamespaceChanges:
                              description: IDs for namespace changes
                              type: array
                              items:
                                type: object
                                required:
                                  - operator
                                  - values
                                properties:
                                  operator:
                                    description: Namespace selector operator.
                                    type: string
                                    enum:
                                      - In
                                      - NotIn
                                  values:
                                    description: Namespace types (e.g., Mnt, Pid) to match.
                                    type: array
                                    items:
                                      type: string
                            matchNamespaces:
                              description: A list of namespaces and IDs
                              type: array
                              items:
                                type: object
                                required:
                                  - namespace
                                  - operator
                                  - values
                                properties:
                                  namespace:
                                    description: Namespace selector name.
                                    type: string
                                    enum:
                                      - Uts
                                      - Ipc
                                      - Mnt
                                      - Pid
                                      - PidForChildren
                                      - Net
                                      - Time
                                      - TimeForChildren
                                      - Cgroup
                                      - User
                                  operator:
                                    description: Namespace selector operator.
                                    type: string
                                    enum:
                                      - In
                                      - NotIn
                                  values:
                                    description: >-
                                      Namespace IDs (or host_ns for host
                                      namespace) of namespaces to match.
                                    type: array
                                    items:
                                      type: string
                            matchPIDs:
                              description: >-
                                A list of process ID filters. MatchPIDs are
                                ANDed.
                              type: array
                              items:
                                type: object
                                required:
                                  - operator
                                  - values
                                properties:
                                  followForks:
                                    description: >-
                                      Matches any descendant processes of the
                                      matching PIDs.
                                    type: boolean
                                    default: false
                                  isNamespacePID:
                                    description: Indicates whether PIDs are namespace PIDs.
                                    type: boolean
                                    default: false
                                  operator:
                                    description: PID selector operator.
                                    type: string
                                    enum:
                                      - In
                                      - NotIn
                                  values:
                                    description: Process IDs to match.
                                    type: array
                                    items:
                                      type: integer
                                      format: int32
                            matchReturnArgs:
                              description: A list of argument filters. MatchArgs are ANDed.
                              type: array
                              items:
                                type: object
                                required:
                                  - index
                                  - operator
                                properties:
                                  index:
                                    description: >-
                                      Position of the argument to apply fhe
                                      filter to.
                                    type: integer
                                    format: int32
                                    minimum: 0
                                  operator:
                                    description: Filter operation.
                                    type: string
                                    enum:
                                      - Equal
                                      - NotEqual
                                      - Prefix
                                      - NotPrefix
                                      - Postfix
                                      - NotPostfix
                                      - GreaterThan
                                      - LessThan
                                      - GT
                                      - LT
                                      - Mask
                                      - SPort
                                      - NotSPort
                                      - SPortPriv
                                      - NotSportPriv
                                      - DPort
                                      - NotDPort
                                      - DPortPriv
                                      - NotDPortPriv
                                      - SAddr
                                      - NotSAddr
                                      - DAddr
                                      - NotDAddr
                                      - Protocol
                                      - Family
                                      - State
                                      - InMap
                                      - NotInMap
                                      - Priority
                                  values:
                                    description: Value to compare the argument against.
                                    type: array
                                    items:
                                      type: string
                      symbol:
                        description: Name of the traced symbol
                        type: string
  conversion:
    strategy: None
